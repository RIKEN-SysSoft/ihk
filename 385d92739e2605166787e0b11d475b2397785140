{
  "comments": [
    {
      "key": {
        "uuid": "ae2fda45_376ddd80",
        "filename": "linux/user/ihkmond.c",
        "patchSetId": 3
      },
      "lineNbr": 119,
      "author": {
        "id": 1014954
      },
      "writtenOn": "2018-10-18T04:26:49Z",
      "side": 1,
      "message": "ERROR: open brace \u0027{\u0027 following function definitions go on the next line\n+static int ihkmond_os_open(int os_index) {",
      "revId": "385d92739e2605166787e0b11d475b2397785140",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5e2b8f54_c8b983af",
        "filename": "linux/user/ihkmond.c",
        "patchSetId": 3
      },
      "lineNbr": 132,
      "author": {
        "id": 1014954
      },
      "writtenOn": "2018-10-18T04:26:49Z",
      "side": 1,
      "message": "WARNING: __func__ should be used instead of gcc specific __FUNCTION__\n+\t\teprintf(\"Warning: %s failed %d times\\n\", __FUNCTION__, i);",
      "revId": "385d92739e2605166787e0b11d475b2397785140",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4c1d8cca_04c47c61",
        "filename": "linux/user/ihkmond.c",
        "patchSetId": 3
      },
      "lineNbr": 163,
      "author": {
        "id": 1014590
      },
      "writtenOn": "2018-11-27T05:02:25Z",
      "side": 1,
      "message": "このあたりに、ファイルの出現を待つループを入れてください。",
      "range": {
        "startLine": 163,
        "startChar": 0,
        "endLine": 163,
        "endChar": 34
      },
      "revId": "385d92739e2605166787e0b11d475b2397785140",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "993a3218_adaa4581",
        "filename": "linux/user/ihkmond.c",
        "patchSetId": 3
      },
      "lineNbr": 163,
      "author": {
        "id": 1015270
      },
      "writtenOn": "2018-12-03T10:31:16Z",
      "side": 1,
      "message": "stat()/access()の2種で待ちループを挿入して試してみましたが、やはりopenが失敗するケースが存在しました。\nstat()/access()がどちらも成功するのにopenだけは失敗(errno\u003dENOENT)となるケースがあるようで、解消には至る事が出来ませんでした。",
      "parentUuid": "4c1d8cca_04c47c61",
      "range": {
        "startLine": 163,
        "startChar": 0,
        "endLine": 163,
        "endChar": 34
      },
      "revId": "385d92739e2605166787e0b11d475b2397785140",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a4d019b1_ad1db1ab",
        "filename": "linux/user/ihkmond.c",
        "patchSetId": 3
      },
      "lineNbr": 163,
      "author": {
        "id": 1003556
      },
      "writtenOn": "2018-12-03T11:20:54Z",
      "side": 1,
      "message": "D\u0027oh, I thought that ENOENT came from the file not being there, but ihk_host_os_open can return ENOENT if (!data || data \u003d\u003d OS_DATA_INVALID)... I bet if you change that return value, you\u0027ll get a different return code there.\nudev_device_get_is_initialized() is pretty much the same as a while(stat() \u003d\u003d -1 \u0026\u0026 errno \u003d\u003d ENOENT) sleep() in more performant so I\u0027m not surprise you get the same result.\n\nWe need to either make ihk_host_os_open wait (I don\u0027t like that idea as if data is OS_DATA_INVALID it could also be past shutdown, and not just pre-boot, and we don\u0027t want to wait in the former case) or just make sure the device is created after the device is ready... I\u0027ll have a look tomorrow morning if I have time.",
      "parentUuid": "993a3218_adaa4581",
      "range": {
        "startLine": 163,
        "startChar": 0,
        "endLine": 163,
        "endChar": 34
      },
      "revId": "385d92739e2605166787e0b11d475b2397785140",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8eeeff21_9ff77f25",
        "filename": "linux/user/ihkmond.c",
        "patchSetId": 3
      },
      "lineNbr": 659,
      "author": {
        "id": 1014590
      },
      "writtenOn": "2018-11-22T04:37:23Z",
      "side": 1,
      "message": "ここにwhile(!udev_device_get_is_initialized(dev)) { }のようなものを入れて試してください。",
      "range": {
        "startLine": 659,
        "startChar": 0,
        "endLine": 659,
        "endChar": 37
      },
      "revId": "385d92739e2605166787e0b11d475b2397785140",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f1054aa7_343eca2b",
        "filename": "linux/user/ihkmond.c",
        "patchSetId": 3
      },
      "lineNbr": 659,
      "author": {
        "id": 1015270
      },
      "writtenOn": "2018-12-03T10:31:16Z",
      "side": 1,
      "message": "while(!udev_device_get_is_initialized(dev)) { usleep(200) }を挿入して試してみましたが、hungup_detected()でopenが失敗する現象は解消出来ませんでした。",
      "parentUuid": "8eeeff21_9ff77f25",
      "range": {
        "startLine": 659,
        "startChar": 0,
        "endLine": 659,
        "endChar": 37
      },
      "revId": "385d92739e2605166787e0b11d475b2397785140",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    }
  ]
}